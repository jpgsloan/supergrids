# OUTPUTS:
#  O1: [CV 1]
#  O2: [CV 2]
#  O3: [CV 3]
#  O4: [CV 4]
#  O5: [CV 5]
#  O6: [CV 6]
#  O7: [CV 7]
#  O8: [CV 8]

# GATES:
#  G1: [Gate 1]
#  G2: [2]
#  G3: [3]
#  G4: [4]
#  G5: [5]
#  G6: [6]
#  G7: [7]
#  G8: [8]
#  G9: [Clock]
#  G10: [Reset]

# CONTROLLER 1:
#  B1.1: [Play]
#  B1.2: [Gates]
#  B1.3: [Reset]
#  B1.4: [Proj]
#  B1.5: [Step 1]
#  B1.6: [2]
#  B1.7: [9]
#  B1.8: [10]

# CONTROLLER 2:
#  B2.1: [Alt]
#  B2.2: [CV]
#  B2.3: [Groove]
#  B2.4: [Perf]
#  B2.5: [3]
#  B2.6: [4]
#  B2.7: [11]
#  B2.8: [12]

# CONTROLLER 3:
#  B3.1: [Select 1]
#  B3.2: [2]
#  B3.3: [5]
#  B3.4: [6]
#  B3.5: [5]
#  B3.6: [6]
#  B3.7: [13]
#  B3.8: [14]

# CONTROLLER 4:
#  B4.1: [3]
#  B4.2: [4]
#  B4.3: [7]
#  B4.4: [8]
#  B4.5: [7]
#  B4.6: [8]
#  B4.7: [15]
#  B4.8: [16]

[p2b8]
[p2b8]
[p2b8]
[p2b8]

# -------------------------------------------------
# Mode Selector
# -------------------------------------------------

# # Button group for mode select of knobs
[buttongroup]
    select = _SEL_BTN_PRSSD_INV
    minactive = 1
    maxactive = 1
    button1 = B1.2
    button2 = B2.1
    button3 = B1.3
    button4 = B1.4
    button5 = B2.3
    led1 = L1.2
    led2 = L2.1
    led3 = L1.3
    led4 = L1.4
    led5 = L2.3
    buttonoutput1 = _GTS_MDE
    buttonoutput2 = _CV_MDE 
    buttonoutput3 = _PROJ_MDE
    buttonoutput4 = _GRVE_MDE 
    buttonoutput5 = _PERF_MDE
    buttonpress = _MDE_PRESSED

# the inverse is used by the activity pots, which must be not selected when changing modes.
[copy]
    input = _MDE_PRESSED
    inverted = _MDE_PRSS_INV

# One of the mode buttons is being held down.
[mixer]
    input1 = B1.2
    input2 = B2.1
    input3 = B1.3
    input4 = B1.4
    input5 = B2.3
    maximum = _MDE_HELD

[copy]
    input =  _MDE_HELD
    inverted = _MDE_HELD_INV

# Toggle mute states for selection.
[copy]
    input = B2.4
    output = _MTE_SELECTION

# -------------------------------------------------
# Midi In
# -------------------------------------------------

# midiin
[midiin]
    channel = _MIDI_IN_CHANNEL + 1
    usb = 1
    notegap = 1
    notegate1 = _MIDI_IN_GATE_1
    notegate2 = _MIDI_IN_GATE_2
    notegate3 = _MIDI_IN_GATE_3
    notegate4 = _MIDI_IN_GATE_4
    notegate5 = _MIDI_IN_GATE_5
    notegate6 = _MIDI_IN_GATE_6
    notegate7 = _MIDI_IN_GATE_7
    notegate8 = _MIDI_IN_GATE_8
    clock = _MIDI_CLK_RAW
    stop = _MIDI_RESET

# -------------------------------------------------
# Project Mode
# -------------------------------------------------

# This MUST be on top of the patch (or at least, no circuits using leds can be places above this).
# The reason for this is that im doing some hacky things with utlizing the led registers (L1.1 etc) directly, mostly in order to use matrix mixers in place of buttongroups because the matrix mixer uses much less ram and can be hacked into being a less advanced group of toggle buttons.
# And as such, we have created the _L1_1 etc, patch cables, which are used in place of the L registers, so that the code can stay organized, and still keep the direct L register references at the top of the patch. 
# This is important because of how the other circuit take over the leds from a top to bottom order. If we had put this at the bottom of the patch, it will be the very last thing applied to the leds and therefor always be showing on top of other circuits.
# Normally, this is all handled automatically by the circuits "select" input. So if anyone seeing this is confused, just know its totally unnecessary unless you are like me doing some crazy optimizations so that the patch will be small enough to work.
[superjust]
    bypass = 1
    input1 = _L1_5
    input2 = _L1_6_B
    input3 = _L1_7_A
    input4 = _L1_8_A
    input5 = _L2_5_B
    input6 = _L2_6_A
    input7 = _L2_7_A
    input8 = _L2_8_A
    output1 = L1.5 
    output2 = L1.6
    output3 = L1.7
    output4 = L1.8
    output5 = L2.5
    output6 = L2.6
    output7 = L2.7
    output8 = L2.8

[superjust]
    bypass = 1
    input1 = _L3_5_B
    input2 = _L3_6_B
    input3 = _L3_7_A
    input4 = _L3_8_A
    input5 = _L4_5_B
    input6 = _L4_6_A
    input7 = _L4_7_A
    input8 = _L4_8_A
    output1 = L3.5 
    output2 = L3.6
    output3 = L3.7
    output4 = L3.8
    output5 = L4.5
    output6 = L4.6
    output7 = L4.7
    output8 = L4.8

# Longpress reset button to clear everything for selected tracks (except for settings).
[button]
    button = B2.2
    states = 0
    startvalue = 0
    longpress = _CLR_PROJECT

# In order to clear all algoquencer states, we have to clear each page separately. these are cleared with the following triggers that come in delayed slighlty from each other. The triggers also determine briefly what page the algos are on. (Gates, Alternate Gates, Accents).
[triggerdelay]
    input = _CLR_PROJECT
    delay = 0.05
    output = _INIT_ALT

[triggerdelay]
    input = _INIT_ALT
    delay = 0.05
    output = _INIT_ACC

[mixer]
    input1 = _CLR_PROJECT
    input2 = _INIT_ALT
    input3 = _INIT_ACC
    output = _CLR_ALGOS

[copy]
    input = _CLR_ALGOS
    inverted = _CLR_ALGOS_INV

# Reset button
[button]
    button = B2.2
    states = 1
    led = L2.2
    output = _INTERNAL_RESET

# use reset button as a clear button, if a mode button is being held when reset pressed
[superjust]
    bypass = 1
    input1 = _MIDI_RESET + _INTERNAL_RESET
    input2 = _COMBINED_RESET * _MDE_HELD_INV 
    input3 = _RESET 
    input4 = B1.2 * B2.2 + _CLR_PROJECT
    input5 = B2.1 * B2.2 + _CLR_PROJECT
    input6 = B1.3 * B2.2 # Don't clear the settings when clearing entire project.
    input7 = B1.4 * B2.2 + _CLR_PROJECT
    input8 = B2.3 * B2.2 + _CLR_PROJECT
    output1 = _COMBINED_RESET
    output2 = _RESET
    output3 = G10
    output4 = _CLR_GTS_MDE
    output5 = _CLR_CV_MDE
    output6 = _CLR_PRJ_MDE
    output7 = _CLR_GRVE
    output8 = _CLR_PERF

# If all channels are selected, and you are clearing the groove OR the entire project, then we can safely reset the globals things like tempo and groove pots.
[compare]
    input = _NUM_SELECTIONS * _CLR_GRVE
    compare = 8 
    ifequal = 1
    else = 0
    output = _CLR_GLBLS

# Clock delay for incoming midi clock in case you need to compensate for things like midi latency
[pot]
    select = _PROJ_MDE
    reset = _CLR_PRJ_MDE
    pot = P1.1
    outputscale = 0.5
    resetvalue = 0
    output = _CLK_DELAY

[triggerdelay]
    input = _MIDI_CLK_RAW
    delay = _CLK_DELAY
    output = _MIDI_CLK

[clocktool]
    clock = _MIDI_CLK
    reset = _RESET
    inputpitch = _MIDI_CLK_RTE

# Math, 2^(rate*10) = hz. 
[math]
    input1 = 2
    input2 = _MIDI_CLK_RTE * 10
    power = _MIDI_CLK_HZ

# Midi settings
[pot]
    select = _PROJ_MDE
    reset = _CLR_PRJ_MDE
    resetvalue = 0
    pot = P2.1
    outputscale = 15
    output = _MIDI_IN_CHANNEL

[pot]
    select = _PROJ_MDE
    reset = _CLR_PRJ_MDE
    resetvalue = 0
    pot = P3.1
    outputscale = 15
    output = _MIDI_OUT_CHANNEL

[pot]
    select = _PROJ_MDE
    reset = _CLR_PRJ_MDE
    resetvalue = 0
    pot = P4.1
    outputscale = 8
    notch = 0.1
    output = _MIDI_NOTE_SEL

# -------------------------------------------------
# Groove Mode
# -------------------------------------------------

# Internal clock master tempo
[pot]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    pot = P1.2
    ledgauge = 0
    outputscale = 4
    resetvalue = 0.5
    notch = 0.1
    output = _INT_HZ
    onchange = _HZ_CHNG

# only allow 6 values per volt (60 values per 10V or 1.0), to match the precision of bpm (1HZ is 60BPM)
# (Also we can only show 3 digits in the X1 register anyway, so incrememnts of 1 bpm at a time)
[quantizer]
    input = _INT_HZ * 4 # multiply by 4 for 16th note granularity
    steps = 6
    output = _INT_HZ_16

# If rate pot is mostly counterclockwise, then we start using midi external clock instead of the internal master tempo. The chosen rate will then get used to drive the internal lfo clocks.
[compare]
    input = _INT_HZ
    compare = 0.02
    ifless = _MIDI_CLK_HZ
    else = _INT_HZ_16 
    output = _INT_OR_MIDI_HZ

# Play/Stop button
[button]
    button = B1.1
    onvalue = _INT_OR_MIDI_HZ
    offvalue = 0
    led = L1.1
    output = _MASTER_HZ

# 0 BPM to 240BPM at 16th notes. Multiply by 4 for 16th notes granularity.
[lfo]
    rate = _LFO_RTE_Q_1 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_1

[lfo]
    rate = _LFO_RTE_Q_2 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_2

[lfo]
    rate = _LFO_RTE_Q_3 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_3

[lfo]
    rate = _LFO_RTE_Q_4 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_4

[lfo]
    rate = _LFO_RTE_Q_5 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_5

[lfo]
    rate = _LFO_RTE_Q_6 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_6

[lfo]
    rate = _LFO_RTE_Q_7 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_7

[lfo]
    rate = _LFO_RTE_Q_8 - 0.2 # from clock div/mult pots
    hz = _MASTER_HZ
    sync = _RESET
    square = _CLK_8

# # POTS for CLOCK DIV/MULT or free tempo per track
[superjust]
    bypass = 1
    input1 = _GRVE_MDE * B1.7
    input2 = _GRVE_MDE * B1.8
    input3 = _GRVE_MDE * B2.7
    input4 = _GRVE_MDE * B2.8
    input5 = _GRVE_MDE * B3.7
    input6 = _GRVE_MDE * B3.8
    input7 = _GRVE_MDE * B4.7
    input8 = _GRVE_MDE * B4.8
    output1 = _RST_TMPO_1
    output2 = _RST_TMPO_2
    output3 = _RST_TMPO_3
    output4 = _RST_TMPO_4
    output5 = _RST_TMPO_5
    output6 = _RST_TMPO_6
    output7 = _RST_TMPO_7
    output8 = _RST_TMPO_8

[pot]
    select = _GRVE_MDE * _SEL_1
    reset = _CLR_GRVE * _SEL_1 + _RST_TMPO_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_1

[pot]
    select = _GRVE_MDE * _SEL_2
    reset = _CLR_GRVE * _SEL_2 + _RST_TMPO_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_2

[pot]
    select = _GRVE_MDE * _SEL_3
    reset = _CLR_GRVE * _SEL_3 + _RST_TMPO_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_3

[pot]
    select = _GRVE_MDE * _SEL_4
    reset = _CLR_GRVE * _SEL_4 + _RST_TMPO_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_4

[pot]
    select = _GRVE_MDE * _SEL_5
    reset = _CLR_GRVE * _SEL_5 + _RST_TMPO_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_5

[pot]
    select = _GRVE_MDE * _SEL_6
    reset = _CLR_GRVE * _SEL_6 + _RST_TMPO_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_6

[pot]
    select = _GRVE_MDE * _SEL_7
    reset = _CLR_GRVE * _SEL_7 + _RST_TMPO_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_7

[pot]
    select = _GRVE_MDE * _SEL_8
    reset = _CLR_GRVE * _SEL_8 + _RST_TMPO_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 0.4
    resetvalue = 0.5
    notch = 0.1
    output = _LFO_RTE_8

# Quantize (or not) the rate to turn it into a more traditional clock mul/div instead of free tempo changing.
[quantizer]
    input = _LFO_RTE_1
    steps = 1
    bypass = _BYPSS_RTE_Q_1
    output = _LFO_RTE_Q_1
[quantizer]
    input = _LFO_RTE_2
    steps = 1
    bypass = _BYPSS_RTE_Q_2
    output = _LFO_RTE_Q_2
[quantizer]
    input = _LFO_RTE_3
    steps = 1
    bypass = _BYPSS_RTE_Q_3
    output = _LFO_RTE_Q_3
[quantizer]
    input = _LFO_RTE_4
    steps = 1
    bypass = _BYPSS_RTE_Q_4
    output = _LFO_RTE_Q_4 
[quantizer]
    input = _LFO_RTE_5
    steps = 1
    bypass = _BYPSS_RTE_Q_5
    output = _LFO_RTE_Q_5
[quantizer]
    input = _LFO_RTE_6
    steps = 1
    bypass = _BYPSS_RTE_Q_6
    output = _LFO_RTE_Q_6
[quantizer]
    input = _LFO_RTE_7
    steps = 1
    bypass = _BYPSS_RTE_Q_7
    output = _LFO_RTE_Q_7
[quantizer]
    input = _LFO_RTE_8
    steps = 1
    bypass = _BYPSS_RTE_Q_8
    output = _LFO_RTE_Q_8

# Select which channels should use traditional clock div/mul instead of free tempo.
[matrixmixer]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 2
    button11 = B1.5 * _GRVE_MDE
    button12 = B1.6 * _GRVE_MDE
    button13 = B2.5 * _GRVE_MDE
    button14 = B2.6 * _GRVE_MDE
    button21 = B3.5 * _GRVE_MDE
    button22 = B3.6 * _GRVE_MDE
    button23 = B4.5 * _GRVE_MDE
    button24 = B4.6 * _GRVE_MDE
    led11 = _BYPSS_RTE_Q_1
    led12 = _BYPSS_RTE_Q_2
    led13 = _BYPSS_RTE_Q_3
    led14 = _BYPSS_RTE_Q_4
    led21 = _BYPSS_RTE_Q_5
    led22 = _BYPSS_RTE_Q_6
    led23 = _BYPSS_RTE_Q_7
    led24 = _BYPSS_RTE_Q_8

[superjust]
    bypass = 1
    input1 = _BYPSS_RTE_Q_1 * _GRVE_MDE #+ L1.5
    input2 = _BYPSS_RTE_Q_2 * _GRVE_MDE #+ L1.6
    input3 = _BYPSS_RTE_Q_3 * _GRVE_MDE #+ L2.5
    input4 = _BYPSS_RTE_Q_4 * _GRVE_MDE #+ L2.6
    input5 = _BYPSS_RTE_Q_5 * _GRVE_MDE #+ L3.5
    input6 = _BYPSS_RTE_Q_6 * _GRVE_MDE #+ L3.6
    input7 = _BYPSS_RTE_Q_7 * _GRVE_MDE #+ L4.5
    input8 = _BYPSS_RTE_Q_8 * _GRVE_MDE #+ L4.6
    output1 = _L1_5 #L1.5
    output2 = _L1_6 #L1.6
    output3 = _L2_5 #L2.5
    output4 = _L2_6 #L2.6
    output5 = _L3_5 #L3.5
    output6 = _L3_6 #L3.6
    output7 = _L4_5 #L4.5
    output8 = _L4_6 #L4.6
    
# Show the internal bpm on the X1 register for 1 second whenever the pot is turned.
[triggerdelay]
    input = _HZ_CHNG
    delay = 0
    gatelength = 1
    output = _SHW_BPM
[math]
    input1 = _INT_HZ * 60 # 1HZ is 60BPM
    input2 = 1000 # divide by 1k to make 3 digit decimal for X1
    quotient = _BPM
[copy]
    input = _BPM * _SHW_BPM
    output = _X1

# # POTS for GROOVE VARIANCE
[pot]
    select = _GRVE_MDE * _SEL_1
    reset = _CLR_GRVE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_1
    righthalf = _GRVE_JITR_1

[pot]
    select = _GRVE_MDE * _SEL_2
    reset = _CLR_GRVE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_2
    righthalf = _GRVE_JITR_2

[pot]
    select = _GRVE_MDE * _SEL_3
    reset = _CLR_GRVE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_3
    righthalf = _GRVE_JITR_3

[pot]
    select = _GRVE_MDE * _SEL_4
    reset = _CLR_GRVE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_4
    righthalf = _GRVE_JITR_4

[pot]
    select = _GRVE_MDE * _SEL_5
    reset = _CLR_GRVE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_5
    righthalf = _GRVE_JITR_5

[pot]
    select = _GRVE_MDE * _SEL_6
    reset = _CLR_GRVE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_6
    righthalf = _GRVE_JITR_6

[pot]
    select = _GRVE_MDE * _SEL_7
    reset = _CLR_GRVE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_7
    righthalf = _GRVE_JITR_7

[pot]
    select = _GRVE_MDE * _SEL_8
    reset = _CLR_GRVE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 1
    resetvalue = 0.5
    notch = 0.1
    lefthalfinv = _GRV_ATN_8
    righthalf = _GRVE_JITR_8

# # GATE LENGTH
[copy]
    input = _GRVE_MDE + _GTS_MDE
    output = _SHW_G_LEN

[copy]
    input = _CLR_GRVE + _CLR_GTS_MDE
    output = _CLR_G_LEN

[pot]
    select = _SHW_G_LEN * _SEL_1
    reset = _CLR_G_LEN * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_1
    righthalf = _G_LEN_ATTN_1

[pot]
    select = _SHW_G_LEN * _SEL_2
    reset = _CLR_G_LEN * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_2
    righthalf = _G_LEN_ATTN_2

[pot]
    select = _SHW_G_LEN * _SEL_3
    reset = _CLR_G_LEN * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_3
    righthalf = _G_LEN_ATTN_3

[pot]
    select = _SHW_G_LEN * _SEL_4
    reset = _CLR_G_LEN * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_4
    righthalf = _G_LEN_ATTN_4

[pot]
    select = _SHW_G_LEN * _SEL_5
    reset = _CLR_G_LEN * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_5
    righthalf = _G_LEN_ATTN_5

[pot]
    select = _SHW_G_LEN * _SEL_6
    reset = _CLR_G_LEN * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_6
    righthalf = _G_LEN_ATTN_6

[pot]
    select = _SHW_G_LEN * _SEL_7
    reset = _CLR_G_LEN * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_7
    righthalf = _G_LEN_ATTN_7

[pot]
    select = _SHW_G_LEN * _SEL_8
    reset = _CLR_G_LEN * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    resetvalue = 0.2
    lefthalfinv = _G_LEN_RW_8
    righthalf = _G_LEN_ATTN_8

[superjust]
    bypass = 1
    input1 = _CV_OUT_1 - 0.5
    input2 = _CV_OUT_2 - 0.5
    input3 = _CV_OUT_3 - 0.5
    input4 = _CV_OUT_4 - 0.5
    input5 = _CV_OUT_5 - 0.5
    input6 = _CV_OUT_6 - 0.5
    input7 = _CV_OUT_7 - 0.5
    input8 = _CV_OUT_8 - 0.5
    output1 = _CV_OUT_NEG_1
    output2 = _CV_OUT_NEG_2
    output3 = _CV_OUT_NEG_3
    output4 = _CV_OUT_NEG_4
    output5 = _CV_OUT_NEG_5
    output6 = _CV_OUT_NEG_6
    output7 = _CV_OUT_NEG_7
    output8 = _CV_OUT_NEG_8

[superjust]
    bypass = 1
    input1 = _G_LEN_ATTN_1 * _CV_OUT_NEG_1 + _G_LEN_RW_1
    input2 = _G_LEN_ATTN_2 * _CV_OUT_NEG_2 + _G_LEN_RW_2
    input3 = _G_LEN_ATTN_3 * _CV_OUT_NEG_3 + _G_LEN_RW_3
    input4 = _G_LEN_ATTN_4 * _CV_OUT_NEG_4 + _G_LEN_RW_4
    input5 = _G_LEN_ATTN_5 * _CV_OUT_NEG_5 + _G_LEN_RW_5
    input6 = _G_LEN_ATTN_6 * _CV_OUT_NEG_6 + _G_LEN_RW_6
    input7 = _G_LEN_ATTN_7 * _CV_OUT_NEG_7 + _G_LEN_RW_7
    input8 = _G_LEN_ATTN_8 * _CV_OUT_NEG_8 + _G_LEN_RW_8
    output1 = _G_LEN_1
    output2 = _G_LEN_2
    output3 = _G_LEN_3
    output4 = _G_LEN_4
    output5 = _G_LEN_5 
    output6 = _G_LEN_6
    output7 = _G_LEN_7
    output8 = _G_LEN_8


# POTS for timing
[pot]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    outputscale = 0.6 
    notch = 0.1
    resetvalue = 0.5 
    output = _TIM_OFFST_1

[pot]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    outputscale = 0.6 
    notch = 0.1
    resetvalue = 0.5 
    output = _TIM_OFFST_2

[pot]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.6 
    notch = 0.1
    resetvalue = 0.5 
    output = _TIM_OFFST_3

[pot]
    select = _GRVE_MDE
    reset = _CLR_GLBLS
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.6 
    notch = 0.1
    resetvalue = 0.5 
    output = _TIM_OFFST_4 

[superjust]
    bypass = 1
    input1 = -1 * 0.3 + _TIM_OFFST_1
    input2 = -1 * 0.3 + _TIM_OFFST_2
    input3 = -1 * 0.3 + _TIM_OFFST_3
    input4 = -1 * 0.3 + _TIM_OFFST_4
    output1 = _TIM_1
    output2 = _TIM_2
    output3 = _TIM_3
    output4 = _TIM_4

[random]
    clock = _CLK_1
    minimum = _GRVE_JITR_1 * -0.2
    maximum = _GRVE_JITR_1 * 0.2
    output = _GRV_RND_1

[random]
    clock = _CLK_2
    minimum = _GRVE_JITR_2 * -0.2
    maximum = _GRVE_JITR_2 * 0.2
    output = _GRV_RND_2

[random]
    clock = _CLK_3
    minimum = _GRVE_JITR_3 * -0.2
    maximum = _GRVE_JITR_3 * 0.2
    output = _GRV_RND_3

[random]
    clock = _CLK_4
    minimum = _GRVE_JITR_4 * -0.2
    maximum = _GRVE_JITR_4 * 0.2
    output = _GRV_RND_4

[random]
    clock = _CLK_5
    minimum = _GRVE_JITR_5 * -0.2
    maximum = _GRVE_JITR_5 * 0.2
    output = _GRV_RND_5

[random]
    clock = _CLK_6
    minimum = _GRVE_JITR_6 * -0.2
    maximum = _GRVE_JITR_6 * 0.2
    output = _GRV_RND_6

[random]
    clock = _CLK_7
    minimum = _GRVE_JITR_7 * -0.2
    maximum = _GRVE_JITR_7 * 0.2
    output = _GRV_RND_7

[random]
    clock = _CLK_8
    minimum = _GRVE_JITR_8 * -0.2
    maximum = _GRVE_JITR_8 * 0.2
    output = _GRV_RND_8

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_1
    reset = _RESET + _RST_TMPO_1
    timing1 = _TIM_1 * _GRV_ATN_1 + _GRV_RND_1
    timing2 = _TIM_2 * _GRV_ATN_1 + _GRV_RND_1
    timing3 = _TIM_3 * _GRV_ATN_1 + _GRV_RND_1
    timing4 = _TIM_4 * _GRV_ATN_1 + _GRV_RND_1
    output = _TIM_CLK_1

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_2
    reset = _RESET + _RST_TMPO_2
    timing1 = _TIM_1 * _GRV_ATN_2 + _GRV_RND_2
    timing2 = _TIM_2 * _GRV_ATN_2 + _GRV_RND_2
    timing3 = _TIM_3 * _GRV_ATN_2 + _GRV_RND_2
    timing4 = _TIM_4 * _GRV_ATN_2 + _GRV_RND_2
    output = _TIM_CLK_2

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_3
    reset = _RESET + _RST_TMPO_3
    timing1 = _TIM_1 * _GRV_ATN_3 + _GRV_RND_3
    timing2 = _TIM_2 * _GRV_ATN_3 + _GRV_RND_3
    timing3 = _TIM_3 * _GRV_ATN_3 + _GRV_RND_3
    timing4 = _TIM_4 * _GRV_ATN_3 + _GRV_RND_3
    output = _TIM_CLK_3

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_4
    reset = _RESET + _RST_TMPO_4
    timing1 = _TIM_1 * _GRV_ATN_4 + _GRV_RND_4
    timing2 = _TIM_2 * _GRV_ATN_4 + _GRV_RND_4
    timing3 = _TIM_3 * _GRV_ATN_4 + _GRV_RND_4
    timing4 = _TIM_4 * _GRV_ATN_4 + _GRV_RND_4
    output = _TIM_CLK_4

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_5
    reset = _RESET + _RST_TMPO_5
    timing1 = _TIM_1 * _GRV_ATN_5 + _GRV_RND_5
    timing2 = _TIM_2 * _GRV_ATN_5 + _GRV_RND_5
    timing3 = _TIM_3 * _GRV_ATN_5 + _GRV_RND_5
    timing4 = _TIM_4 * _GRV_ATN_5 + _GRV_RND_5
    output = _TIM_CLK_5

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_6
    reset = _RESET + _RST_TMPO_6
    timing1 = _TIM_1 * _GRV_ATN_6 + _GRV_RND_6
    timing2 = _TIM_2 * _GRV_ATN_6 + _GRV_RND_6
    timing3 = _TIM_3 * _GRV_ATN_6 + _GRV_RND_6
    timing4 = _TIM_4 * _GRV_ATN_6 + _GRV_RND_6
    output = _TIM_CLK_6

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_7
    reset = _RESET + _RST_TMPO_7
    timing1 = _TIM_1 * _GRV_ATN_7 + _GRV_RND_7
    timing2 = _TIM_2 * _GRV_ATN_7 + _GRV_RND_7
    timing3 = _TIM_3 * _GRV_ATN_7 + _GRV_RND_7
    timing4 = _TIM_4 * _GRV_ATN_7 + _GRV_RND_7
    output = _TIM_CLK_7

# Adjust per step (up to 8 steps) timing PER CHANNEL!
[timing]
    clock = _CLK_8
    reset = _RESET + _RST_TMPO_8
    timing1 = _TIM_1 * _GRV_ATN_8 + _GRV_RND_8
    timing2 = _TIM_2 * _GRV_ATN_8 + _GRV_RND_8
    timing3 = _TIM_3 * _GRV_ATN_8 + _GRV_RND_8
    timing4 = _TIM_4 * _GRV_ATN_8 + _GRV_RND_8
    output = _TIM_CLK_8

# -------------------------------------------------
# Performance Mode
# -------------------------------------------------

# # POTS for Activity
# calculate when activity pots should be selected. If you are holding down the performance mode button, the variation knobs are selected, otherwise the activity knobs are selected.
[superjust]
    bypass = 1
    input1 = B2.3
    output1 = _VAR_PERF_POTS
    input2 = 1 - B2.3
    output2 = _ACT_PERF_POTS
    input3 = _PERF_MDE * _ACT_PERF_POTS
    output3 =_ACT_PERF_MDE
    input4 = 1 - _PERF_MDE
    output4 = _PRF_MD_INV
    input5 = 16
    output5 = _NUM_PAT
    input6 = _PERF_MDE * _VAR_PERF_POTS
    output6 = _VAR_PERF_MDE

[superjust]
    bypass = 1
    input1 = _GTS_MDE * _SEL_1 + _ACT_PERF_MDE
    input2 = _GTS_MDE * _SEL_2 + _ACT_PERF_MDE
    input3 = _GTS_MDE * _SEL_3 + _ACT_PERF_MDE
    input4 = _GTS_MDE * _SEL_4 + _ACT_PERF_MDE
    input5 = _GTS_MDE * _SEL_5 + _ACT_PERF_MDE
    input6 = _GTS_MDE * _SEL_6 + _ACT_PERF_MDE
    input7 = _GTS_MDE * _SEL_7 + _ACT_PERF_MDE
    input8 = _GTS_MDE * _SEL_8 + _ACT_PERF_MDE
    output1 = _ACT_SEL_1
    output2 = _ACT_SEL_2
    output3 = _ACT_SEL_3
    output4 = _ACT_SEL_4
    output5 = _ACT_SEL_5
    output6 = _ACT_SEL_6
    output7 = _ACT_SEL_7
    output8 = _ACT_SEL_8

# Switch pots based on if you are in performance mode or not
[superjust]
    bypass = 1
    input1 = _PERF_MDE * P1.1
    input2 = _PERF_MDE * P2.1
    input3 = _PERF_MDE * P3.1
    input4 = _PERF_MDE * P4.1
    input5 = _PERF_MDE * P1.2
    input6 = _PERF_MDE * P2.2
    input7 = _PERF_MDE * P3.2
    input8 = _PERF_MDE * P4.2
    output1 = _PRF_PT_1
    output2 = _PRF_PT_2
    output3 = _PRF_PT_3
    output4 = _PRF_PT_4
    output5 = _PRF_PT_5
    output6 = _PRF_PT_6
    output7 = _PRF_PT_7
    output8 = _PRF_PT_8

[superjust]
    bypass = 1
    input1 = _PRF_MD_INV * P1.1 + _PRF_PT_1
    input2 = _PRF_MD_INV * P1.1 + _PRF_PT_2
    input3 = _PRF_MD_INV * P1.1 + _PRF_PT_3
    input4 = _PRF_MD_INV * P1.1 + _PRF_PT_4
    input5 = _PRF_MD_INV * P1.1 + _PRF_PT_5
    input6 = _PRF_MD_INV * P1.1 + _PRF_PT_6
    input7 = _PRF_MD_INV * P1.1 + _PRF_PT_7
    input8 = _PRF_MD_INV * P1.1 + _PRF_PT_8
    output1 = _ACT_POT_1
    output2 = _ACT_POT_2
    output3 = _ACT_POT_3
    output4 = _ACT_POT_4
    output5 = _ACT_POT_5
    output6 = _ACT_POT_6
    output7 = _ACT_POT_7
    output8 = _ACT_POT_8

[pot]
    select = _ACT_SEL_1 * _MDE_PRSS_INV # You dont want this pot selected, when you are switching modes, or else the pot value will jump immediately.
    reset = _CLR_GTS_MDE * _SEL_1 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_1
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_1

[pot]
    select = _ACT_SEL_2 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_2 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_2
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_2

[pot]
    select = _ACT_SEL_3 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_3 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_3
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_3

[pot]
    select = _ACT_SEL_4 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_4 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_4
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_4

[pot]
    select = _ACT_SEL_5 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_5 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_5
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_5

[pot]
    select = _ACT_SEL_6 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_6 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_6
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_6

[pot]
    select = _ACT_SEL_7 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_7 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_7
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_7

[pot]
    select = _ACT_SEL_8 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_8 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _ACT_POT_8
    resetvalue = 0.5
    notch = 0.1
    output = _ACT_8

# POTS for gate variation
# Switch pots based on if you are in performance mode or not. But only show the variation pots if holding down the performance mode button.
[superjust]
    bypass = 1
    input1 = _GTS_MDE * _SEL_1 + _VAR_PERF_MDE
    input2 = _GTS_MDE * _SEL_2 + _VAR_PERF_MDE
    input3 = _GTS_MDE * _SEL_3 + _VAR_PERF_MDE
    input4 = _GTS_MDE * _SEL_4 + _VAR_PERF_MDE
    input5 = _GTS_MDE * _SEL_5 + _VAR_PERF_MDE
    input6 = _GTS_MDE * _SEL_6 + _VAR_PERF_MDE
    input7 = _GTS_MDE * _SEL_7 + _VAR_PERF_MDE
    input8 = _GTS_MDE * _SEL_8 + _VAR_PERF_MDE
    output1 = _VAR_SEL_1
    output2 = _VAR_SEL_2
    output3 = _VAR_SEL_3
    output4 = _VAR_SEL_4
    output5 = _VAR_SEL_5
    output6 = _VAR_SEL_6
    output7 = _VAR_SEL_7
    output8 = _VAR_SEL_8

[superjust]
    bypass = 1
    input1 = _PRF_MD_INV * P2.1 + _PRF_PT_1
    input2 = _PRF_MD_INV * P2.1 + _PRF_PT_2
    input3 = _PRF_MD_INV * P2.1 + _PRF_PT_3
    input4 = _PRF_MD_INV * P2.1 + _PRF_PT_4
    input5 = _PRF_MD_INV * P2.1 + _PRF_PT_5
    input6 = _PRF_MD_INV * P2.1 + _PRF_PT_6
    input7 = _PRF_MD_INV * P2.1 + _PRF_PT_7
    input8 = _PRF_MD_INV * P2.1 + _PRF_PT_8
    output1 = _VAR_POT_1
    output2 = _VAR_POT_2
    output3 = _VAR_POT_3
    output4 = _VAR_POT_4
    output5 = _VAR_POT_5
    output6 = _VAR_POT_6
    output7 = _VAR_POT_7
    output8 = _VAR_POT_8

# # POTS for variation
[pot]
    select = _VAR_SEL_1 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_1 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_1
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_1

[pot]
    select = _VAR_SEL_2 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_2 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_2
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_2

[pot]
    select = _VAR_SEL_3 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_3 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_3
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_3

[pot]
    select = _VAR_SEL_4 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_4 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_4
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_4

[pot]
    select = _VAR_SEL_5 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_5 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_5
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_5

[pot]
    select = _VAR_SEL_6 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_6 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_6
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_6

[pot]
    select = _VAR_SEL_7 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_7 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_7
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_7

[pot]
    select = _VAR_SEL_8 * _MDE_PRSS_INV
    reset = _CLR_GTS_MDE * _SEL_8 + _CLR_PERF
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = _VAR_POT_8
    resetvalue = 0
    discrete = 16
    outputscale = 0.0625
    output = _VAR_8

# Buttongroup for selecting presets
[buttongroup]
    select = _PERF_MDE
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8
    output = _PRST
    buttonpress = _LD #_PRST_PRESSED
    longpress = _SV

[copy]
    input = _SV + _X1
    output = X1

# -------------------------------------------------
# Gates Mode
# -------------------------------------------------

# Activity and Variation are both using the same pots from performance mode.

# # POTS for offbeats
[pot]
    select = _GTS_MDE * _SEL_1
    reset = _CLR_GTS_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_1

[pot]
    select = _GTS_MDE * _SEL_2
    reset = _CLR_GTS_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_2

[pot]
    select = _GTS_MDE * _SEL_3
    reset = _CLR_GTS_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_3

[pot]
    select = _GTS_MDE * _SEL_4
    reset = _CLR_GTS_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_4

[pot]
    select = _GTS_MDE * _SEL_5
    reset = _CLR_GTS_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_5

[pot]
    select = _GTS_MDE * _SEL_6
    reset = _CLR_GTS_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_6

[pot]
    select = _GTS_MDE * _SEL_7
    reset = _CLR_GTS_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_7

[pot]
    select = _GTS_MDE * _SEL_8
    reset = _CLR_GTS_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    notch = 0.1
    resetvalue = 0.5
    output = _OFFBTS_8

# # POTS for Rolls
[pot]
    select = _GTS_MDE * _SEL_1
    reset = _CLR_GTS_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_1

[pot]
    select = _GTS_MDE * _SEL_2
    reset = _CLR_GTS_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_2

[pot]
    select = _GTS_MDE * _SEL_3
    reset = _CLR_GTS_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_3

[pot]
    select = _GTS_MDE * _SEL_4
    reset = _CLR_GTS_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_4

[pot]
    select = _GTS_MDE * _SEL_5
    reset = _CLR_GTS_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_5

[pot]
    select = _GTS_MDE * _SEL_6
    reset = _CLR_GTS_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_6

[pot]
    select = _GTS_MDE * _SEL_7
    reset = _CLR_GTS_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_7

[pot]
    select = _GTS_MDE * _SEL_8
    reset = _CLR_GTS_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    resetvalue = 0
    output = _RLLS_8

# # POTS for gates Deja Vu (pot value flipped for personal preference, to match things like activity or fills)
[pot]
    select = _GTS_MDE * _SEL_1
    reset = _CLR_GTS_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_1

[pot]
    select = _GTS_MDE * _SEL_2
    reset = _CLR_GTS_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_2

[pot]
    select = _GTS_MDE * _SEL_3
    reset = _CLR_GTS_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_3

[pot]
    select = _GTS_MDE * _SEL_4
    reset = _CLR_GTS_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_4

[pot]
    select = _GTS_MDE * _SEL_5
    reset = _CLR_GTS_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_5

[pot]
    select = _GTS_MDE * _SEL_6
    reset = _CLR_GTS_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_6

[pot]
    select = _GTS_MDE * _SEL_7
    reset = _CLR_GTS_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_7

[pot]
    select = _GTS_MDE * _SEL_8
    reset = _CLR_GTS_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _DEJA_8

# # POTS for Alternatebars
[pot]
    select = _GTS_MDE * _SEL_1
    reset = _CLR_GTS_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_1

[pot]
    select = _GTS_MDE * _SEL_2
    reset = _CLR_GTS_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_2

[pot]
    select = _GTS_MDE * _SEL_3
    reset = _CLR_GTS_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_3

[pot]
    select = _GTS_MDE * _SEL_4
    reset = _CLR_GTS_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_4

[pot]
    select = _GTS_MDE * _SEL_5
    reset = _CLR_GTS_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_5

[pot]
    select = _GTS_MDE * _SEL_6
    reset = _CLR_GTS_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_6

[pot]
    select = _GTS_MDE * _SEL_7
    reset = _CLR_GTS_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_7

[pot]
    select = _GTS_MDE * _SEL_8
    reset = _CLR_GTS_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    resetvalue = 0.5
    discrete = 8
    output = _ALT_8

# Pot for determining which mode to display on the algo step buttons.
[pot]
    select = _GTS_MDE
    reset = _CLR_GTS_MDE
    pot = P3.2
    outputscale = 2
    notch = 0.1
    resetvalue = 0.5
    output = _ALG_MDE

[math]
    input1 = _ALG_MDE
    round = _ALG_MDE_RND

[compare]
    input = _ALG_MDE_RND
    compare = 0
    ifequal = 1
    else = 0
    output = _ALT_G_MDE

[compare]
    input = _ALG_MDE_RND
    compare = 2
    ifequal = 1
    else = 0
    output = _LEN_MDE

# Gatelength pots are reused here from groove mode.

# -------------------------------------------------
# CV mode
# -------------------------------------------------

# # POTS for cv activity
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.1
    resetvalue = 0.5
    notch = 0.1
    output = _CV_ACT_8

# # POTS for cv variation
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.1
    resetvalue = 0
    notch = 0.1
    output = _CV_VAR_8

# # POTS for base pitch
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.1
    outputscale = 0.5
    resetvalue = 0.5
    notch = 0.1
    bipolar = _CV_BASE_8

# # POTS for pitch range
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.1
    outputscale = 0.5
    resetvalue = 0.2
    notch = 0.1
    output = _CV_SPRD_8

# # POTS for CV Deja Vu (pot value flipped for personal preference, to match things like activity or fills)
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P1.2
    outputscale = -1
    resetvalue = 0
    slope = 2
    output = _CV_DEJA_8

# # POTS for pitch resolution
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P2.2
    outputscale = 1
    resetvalue = 0.5
    output = _CV_RES_8

# # POTS for cv slew
[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P3.2
    outputscale = 0.4
    slope = 2
    resetvalue = 0
    output = _SLEW_8

[pot]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_1

[pot]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_2

[pot]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_3

[pot]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_4

[pot]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_5

[pot]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_6

[pot]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_7

[pot]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    pot = P4.2
    outputscale = 0.2
    notch = 0.05
    resetvalue = 0
    output = _BYPSS_QUANT_8

# Quantization Keyboard    
[superjust]
    bypass = 1
    input1 = _CV_MDE * _SEL_1
    input2 = _CV_MDE * _SEL_2
    input3 = _CV_MDE * _SEL_3
    input4 = _CV_MDE * _SEL_4
    input5 = _CV_MDE * _SEL_5
    input6 = _CV_MDE * _SEL_6
    input7 = _CV_MDE * _SEL_7
    input8 = _CV_MDE * _SEL_8
    output1 = _KEYS_1
    output2 = _KEYS_2
    output3 = _KEYS_3
    output4 = _KEYS_4
    output5 = _KEYS_5
    output6 = _KEYS_6
    output7 = _KEYS_7
    output8 = _KEYS_8

[matrixmixer]
    select = _CV_MDE * _SEL_1
    reset = _CLR_CV_MDE * _SEL_1
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_1
    button12 = B1.6 * _KEYS_1
    button13 = B1.8 * _KEYS_1
    button14 = B2.5 * _KEYS_1
    button21 = B2.7 * _KEYS_1
    button22 = B2.8 * _KEYS_1
    button23 = B3.5 * _KEYS_1
    button24 = B3.7 * _KEYS_1
    button31 = B3.6 * _KEYS_1
    button32 = B3.8 * _KEYS_1
    button33 = B4.5 * _KEYS_1
    button34 = B4.7 * _KEYS_1
    button41 = B4.8 * _KEYS_1
    led11 = _C_1
    led12 = _C_SH_1
    led13 = _D_1
    led14 = _D_SH_1
    led21 = _E_1
    led22 = _F_1
    led23 = _F_SH_1
    led24 = _G_1
    led31 = _G_SH_1
    led32 = _A_1
    led33 = _A_SH_1
    led34 = _B_1
    led41 = _C_OCT_1

[matrixmixer]
    select = _CV_MDE * _SEL_2
    reset = _CLR_CV_MDE * _SEL_2
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_2
    button12 = B1.6 * _KEYS_2
    button13 = B1.8 * _KEYS_2
    button14 = B2.5 * _KEYS_2
    button21 = B2.7 * _KEYS_2
    button22 = B2.8 * _KEYS_2
    button23 = B3.5 * _KEYS_2
    button24 = B3.7 * _KEYS_2
    button31 = B3.6 * _KEYS_2
    button32 = B3.8 * _KEYS_2
    button33 = B4.5 * _KEYS_2
    button34 = B4.7 * _KEYS_2
    button41 = B4.8 * _KEYS_2
    led11 = _C_2
    led12 = _C_SH_2
    led13 = _D_2
    led14 = _D_SH_2
    led21 = _E_2
    led22 = _F_2
    led23 = _F_SH_2
    led24 = _G_2
    led31 = _G_SH_2
    led32 = _A_2
    led33 = _A_SH_2
    led34 = _B_2
    led41 = _C_OCT_2

[matrixmixer]
    select = _CV_MDE * _SEL_3
    reset = _CLR_CV_MDE * _SEL_3
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_3
    button12 = B1.6 * _KEYS_3
    button13 = B1.8 * _KEYS_3
    button14 = B2.5 * _KEYS_3
    button21 = B2.7 * _KEYS_3
    button22 = B2.8 * _KEYS_3
    button23 = B3.5 * _KEYS_3
    button24 = B3.7 * _KEYS_3
    button31 = B3.6 * _KEYS_3
    button32 = B3.8 * _KEYS_3
    button33 = B4.5 * _KEYS_3
    button34 = B4.7 * _KEYS_3
    button41 = B4.8 * _KEYS_3
    led11 = _C_3
    led12 = _C_SH_3
    led13 = _D_3
    led14 = _D_SH_3
    led21 = _E_3
    led22 = _F_3
    led23 = _F_SH_3
    led24 = _G_3
    led31 = _G_SH_3
    led32 = _A_3
    led33 = _A_SH_3
    led34 = _B_3
    led41 = _C_OCT_3

[matrixmixer]
    select = _CV_MDE * _SEL_4
    reset = _CLR_CV_MDE * _SEL_4
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_4
    button12 = B1.6 * _KEYS_4
    button13 = B1.8 * _KEYS_4
    button14 = B2.5 * _KEYS_4
    button21 = B2.7 * _KEYS_4
    button22 = B2.8 * _KEYS_4
    button23 = B3.5 * _KEYS_4
    button24 = B3.7 * _KEYS_4
    button31 = B3.6 * _KEYS_4
    button32 = B3.8 * _KEYS_4
    button33 = B4.5 * _KEYS_4
    button34 = B4.7 * _KEYS_4
    button41 = B4.8 * _KEYS_4
    led11 = _C_4
    led12 = _C_SH_4
    led13 = _D_4
    led14 = _D_SH_4
    led21 = _E_4
    led22 = _F_4
    led23 = _F_SH_4
    led24 = _G_4
    led31 = _G_SH_4
    led32 = _A_4
    led33 = _A_SH_4
    led34 = _B_4
    led41 = _C_OCT_4

[matrixmixer]
    select = _CV_MDE * _SEL_5
    reset = _CLR_CV_MDE * _SEL_5
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_5
    button12 = B1.6 * _KEYS_5
    button13 = B1.8 * _KEYS_5
    button14 = B2.5 * _KEYS_5
    button21 = B2.7 * _KEYS_5
    button22 = B2.8 * _KEYS_5
    button23 = B3.5 * _KEYS_5
    button24 = B3.7 * _KEYS_5
    button31 = B3.6 * _KEYS_5
    button32 = B3.8 * _KEYS_5
    button33 = B4.5 * _KEYS_5
    button34 = B4.7 * _KEYS_5
    button41 = B4.8 * _KEYS_5
    led11 = _C_5
    led12 = _C_SH_5
    led13 = _D_5 
    led14 = _D_SH_5
    led21 = _E_5
    led22 = _F_5
    led23 = _F_SH_5
    led24 = _G_5
    led31 = _G_SH_5
    led32 = _A_5
    led33 = _A_SH_5
    led34 = _B_5
    led41 = _C_OCT_5

[matrixmixer]
    select = _CV_MDE * _SEL_6
    reset = _CLR_CV_MDE * _SEL_6
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 * _KEYS_6
    button12 = B1.6 * _KEYS_6
    button13 = B1.8 * _KEYS_6
    button14 = B2.5 * _KEYS_6
    button21 = B2.7 * _KEYS_6
    button22 = B2.8 * _KEYS_6
    button23 = B3.5 * _KEYS_6
    button24 = B3.7 * _KEYS_6
    button31 = B3.6 * _KEYS_6
    button32 = B3.8 * _KEYS_6
    button33 = B4.5 * _KEYS_6
    button34 = B4.7 * _KEYS_6
    button41 = B4.8 * _KEYS_6
    led11 = _C_6
    led12 = _C_SH_6
    led13 = _D_6
    led14 = _D_SH_6
    led21 = _E_6 
    led22 = _F_6
    led23 = _F_SH_6
    led24 = _G_6
    led31 = _G_SH_6
    led32 = _A_6
    led33 = _A_SH_6
    led34 = _B_6
    led41 = _C_OCT_6

[matrixmixer]
    select = _CV_MDE * _SEL_7
    reset = _CLR_CV_MDE * _SEL_7
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 
    button12 = B1.6 
    button13 = B1.8 
    button14 = B2.5 
    button21 = B2.7 
    button22 = B2.8 
    button23 = B3.5 
    button24 = B3.7 
    button31 = B3.6 
    button32 = B3.8 
    button33 = B4.5 
    button34 = B4.7 
    button41 = B4.8 
    led11 = _C_7
    led12 = _C_SH_7
    led13 = _D_7
    led14 = _D_SH_7
    led21 = _E_7
    led22 = _F_7
    led23 = _F_SH_7
    led24 = _G_7
    led31 = _G_SH_7
    led32 = _A_7
    led33 = _A_SH_7
    led34 = _B_7
    led41 = _C_OCT_7

[matrixmixer]
    select = _CV_MDE * _SEL_8
    reset = _CLR_CV_MDE * _SEL_8
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    input1 = 1
    input2 = 1
    input3 = 1
    input4 = 1
    startvalue = 0
    button11 = B1.7 
    button12 = B1.6 
    button13 = B1.8 
    button14 = B2.5 
    button21 = B2.7 
    button22 = B2.8 
    button23 = B3.5 
    button24 = B3.7 
    button31 = B3.6
    button32 = B3.8
    button33 = B4.5
    button34 = B4.7
    button41 = B4.8
    led11 = _C_8
    led12 = _C_SH_8
    led13 = _D_8
    led14 = _D_SH_8
    led21 = _E_8
    led22 = _F_8
    led23 = _F_SH_8
    led24 = _G_8
    led31 = _G_SH_8
    led32 = _A_8
    led33 = _A_SH_8
    led34 = _B_8
    led41 = _C_OCT_8

[mixer]
    input1 = _C_1 * _KEYS_1 #+ _L1_7
    input2 = _C_2 * _KEYS_2 #+ _L1_7
    input3 = _C_3 * _KEYS_3 #+ _L1_7
    input4 = _C_4 * _KEYS_4 #+ _L1_7
    input5 = _C_5 * _KEYS_5 #+ _L1_7
    input6 = _C_6 * _KEYS_6 #+ _L1_7
    input7 = _C_7 * _KEYS_7 #+ _L1_7
    input8 = _C_8 * _KEYS_8 #+ _L1_7 
    maximum = _L1_7

[mixer]
    input1 = _C_SH_1 * _KEYS_1 + _L1_6
    input2 = _C_SH_2 * _KEYS_2 + _L1_6
    input3 = _C_SH_3 * _KEYS_3 + _L1_6
    input4 = _C_SH_4 * _KEYS_4 + _L1_6
    input5 = _C_SH_5 * _KEYS_5 + _L1_6
    input6 = _C_SH_6 * _KEYS_6 + _L1_6
    input7 = _C_SH_7 * _KEYS_7 + _L1_6
    input8 = _C_SH_8 * _KEYS_8 + _L1_6
    maximum = _L1_6_A

[mixer]
    input1 = _D_1 * _KEYS_1 #+ _L1_8
    input2 = _D_2 * _KEYS_2 #+ _L1_8
    input3 = _D_3 * _KEYS_3 #+ _L1_8
    input4 = _D_4 * _KEYS_4 #+ _L1_8
    input5 = _D_5 * _KEYS_5 #+ _L1_8
    input6 = _D_6 * _KEYS_6 #+ _L1_8
    input7 = _D_7 * _KEYS_7 #+ _L1_8
    input8 = _D_8 * _KEYS_8 #+ _L1_8
    maximum = _L1_8

[mixer]
    input1 = _D_SH_1 * _KEYS_1 + _L2_5
    input2 = _D_SH_2 * _KEYS_2 + _L2_5
    input3 = _D_SH_3 * _KEYS_3 + _L2_5
    input4 = _D_SH_4 * _KEYS_4 + _L2_5
    input5 = _D_SH_5 * _KEYS_5 + _L2_5
    input6 = _D_SH_6 * _KEYS_6 + _L2_5
    input7 = _D_SH_7 * _KEYS_7 + _L2_5
    input8 = _D_SH_8 * _KEYS_8 + _L2_5
    maximum = _L2_5_A

[mixer]
    input1 = _E_1 * _KEYS_1 #+ _L2_7
    input2 = _E_2 * _KEYS_2 #+ _L2_7
    input3 = _E_3 * _KEYS_3 #+ _L2_7
    input4 = _E_4 * _KEYS_4 #+ _L2_7
    input5 = _E_5 * _KEYS_5 #+ _L2_7
    input6 = _E_6 * _KEYS_6 #+ _L2_7
    input7 = _E_7 * _KEYS_7 #+ _L2_7
    input8 = _E_8 * _KEYS_8 #+ _L2_7
    maximum = _L2_7

[mixer]
    input1 = _F_1 * _KEYS_1 #+ _L2_8
    input2 = _F_2 * _KEYS_2 #+ _L2_8
    input3 = _F_3 * _KEYS_3 #+ _L2_8
    input4 = _F_4 * _KEYS_4 #+ _L2_8
    input5 = _F_5 * _KEYS_5 #+ _L2_8
    input6 = _F_6 * _KEYS_6 #+ _L2_8
    input7 = _F_7 * _KEYS_7 #+ _L2_8
    input8 = _F_8 * _KEYS_8 #+ _L2_8
    maximum = _L2_8

[mixer]
    input1 = _F_SH_1 * _KEYS_1 + _L3_5
    input2 = _F_SH_2 * _KEYS_2 + _L3_5
    input3 = _F_SH_3 * _KEYS_3 + _L3_5
    input4 = _F_SH_4 * _KEYS_4 + _L3_5
    input5 = _F_SH_5 * _KEYS_5 + _L3_5
    input6 = _F_SH_6 * _KEYS_6 + _L3_5
    input7 = _F_SH_7 * _KEYS_7 + _L3_5
    input8 = _F_SH_8 * _KEYS_8 + _L3_5
    maximum = _L3_5_A

[mixer]
    input1 = _G_1 * _KEYS_1 # _L3_7
    input2 = _G_2 * _KEYS_2 #+ _L3_7
    input3 = _G_3 * _KEYS_3 #+ _L3_7
    input4 = _G_4 * _KEYS_4 #+ _L3_7
    input5 = _G_5 * _KEYS_5 #+ _L3_7
    input6 = _G_6 * _KEYS_6 #+ _L3_7
    input7 = _G_7 * _KEYS_7 #+ _L3_7
    input8 = _G_8 * _KEYS_8 #+ _L3_7
    maximum = _L3_7

[mixer]
    input1 = _G_SH_1 * _KEYS_1 + _L3_6
    input2 = _G_SH_2 * _KEYS_2 + _L3_6
    input3 = _G_SH_3 * _KEYS_3 + _L3_6
    input4 = _G_SH_4 * _KEYS_4 + _L3_6
    input5 = _G_SH_5 * _KEYS_5 + _L3_6
    input6 = _G_SH_6 * _KEYS_6 + _L3_6
    input7 = _G_SH_7 * _KEYS_7 + _L3_6
    input8 = _G_SH_8 * _KEYS_8 + _L3_6
    maximum = _L3_6_A

[mixer]
    input1 = _A_1 * _KEYS_1 #+ _L3_8
    input2 = _A_2 * _KEYS_2 #+ _L3_8
    input3 = _A_3 * _KEYS_3 #+ _L3_8
    input4 = _A_4 * _KEYS_4 #+ _L3_8
    input5 = _A_5 * _KEYS_5 #+ _L3_8
    input6 = _A_6 * _KEYS_6 #+ _L3_8
    input7 = _A_7 * _KEYS_7 #+ _L3_8
    input8 = _A_8 * _KEYS_8 #+ _L3_8
    maximum = _L3_8

[mixer]
    input1 = _A_SH_1 * _KEYS_1 + _L4_5
    input2 = _A_SH_2 * _KEYS_2 + _L4_5
    input3 = _A_SH_3 * _KEYS_3 + _L4_5
    input4 = _A_SH_4 * _KEYS_4 + _L4_5
    input5 = _A_SH_5 * _KEYS_5 + _L4_5
    input6 = _A_SH_6 * _KEYS_6 + _L4_5
    input7 = _A_SH_7 * _KEYS_7 + _L4_5
    input8 = _A_SH_8 * _KEYS_8 + _L4_5
    maximum = _L4_5_A

[mixer]
    input1 = _B_1 * _KEYS_1 #+ _L4_7
    input2 = _B_2 * _KEYS_2 #+ _L4_7
    input3 = _B_3 * _KEYS_3 #+ _L4_7
    input4 = _B_4 * _KEYS_4 #+ _L4_7
    input5 = _B_5 * _KEYS_5 #+ _L4_7
    input6 = _B_6 * _KEYS_6 #+ _L4_7
    input7 = _B_7 * _KEYS_7 #+ _L4_7
    input8 = _B_8 * _KEYS_8 #+ _L4_7
    maximum = _L4_7

[mixer]
    input1 = _C_OCT_1 * _KEYS_1 #+ _L4_8
    input2 = _C_OCT_2 * _KEYS_2 #+ _L4_8
    input3 = _C_OCT_3 * _KEYS_3 #+ _L4_8
    input4 = _C_OCT_4 * _KEYS_4 #+ _L4_8
    input5 = _C_OCT_5 * _KEYS_5 #+ _L4_8
    input6 = _C_OCT_6 * _KEYS_6 #+ _L4_8
    input7 = _C_OCT_7 * _KEYS_7 #+ _L4_8
    input8 = _C_OCT_8 * _KEYS_8 #+ _L4_8
    maximum = _L4_8

# Create half-lit chromatic keyboard on the step button leds. 
# Superjust circuit is the most efficient way to do simple math with 8 ins and outs. 
# The circuit itself is doing nothing in this case, just using it as a cheap way to send inputs to outputs.
[superjust]
    bypass = 1
    input1 = 0.2 * _CV_MDE + _L1_7
    input2 = 0.1 * _CV_MDE + _L1_6_A
    input3 = 0.2 * _CV_MDE + _L1_8 
    input4 = 0.1 * _CV_MDE + _L2_5_A
    input5 = 0.2 * _CV_MDE + _L2_7
    input6 = 0.2 * _CV_MDE + _L2_8
    input7 = 0.1 * _CV_MDE + _L3_5_A
    input8 = 0.2 * _CV_MDE + _L3_7
    output1 = _L1_7_A
    output2 = _L1_6_B
    output3 = _L1_8_A
    output4 = _L2_5_B
    output5 = _L2_7_A
    output6 = _L2_8_A
    output7 = _L3_5_B
    output8 = _L3_7_A

[copy]
    input = _CV_MDE
    inverted = _CV_MDE_INV

[superjust]
    bypass = 1
    input1 = 0.1 * _CV_MDE + _L3_6_A
    input2 = 0.2 * _CV_MDE + _L3_8
    input3 = 0.1 * _CV_MDE + _L4_5_A
    input4 = 0.2 * _CV_MDE + _L4_7
    input5 = 0.2 * _CV_MDE + _L4_8
    input6 = _CV_MDE_INV * _L2_6
    input7 = _CV_MDE_INV * _L4_6
    output1 = _L3_6_B
    output2 = _L3_8_A
    output3 = _L4_5_B
    output4 = _L4_7_A
    output5 = _L4_8_A
    output6 = _L2_6_A
    output7 = _L4_6_A

# -------------------------------------------------
# Channel Selector
# -------------------------------------------------

# Detect double clicks
[triggerdelay]
    input = _CH_BUTTON_PRESSED
    delay = 0.1
    gatelength = 0.1 
    output = _SHLD_SMPLE

[sample]
    input = _BTN_NUM
    sample = _SHLD_SMPLE
    output = _LAST_BTN_PRS

[compare]
    input = _LAST_BTN_PRS * _SHLD_SMPLE
    compare = _BTN_NUM
    ifequal = 1
    else = 0
    output = _SHLD_ALLW_DBLE

[button]
    doubleclickmode = 1
    button = _CH_BUTTON_PRESSED * _SHLD_ALLW_DBLE
    onvalue = 1
    offvalue = 0
    startvalue = 0
    reset = _DBL_CLK_RST
    output = _DBL_CLKD

[triggerdelay]
    input = _DBL_CLKD
    delay = 0.1
    gatelength = 0.01
    output = _DBL_CLK_RST

[compare]
    input = _NUM_SELECTIONS + _NUM_BUTTONS_PRESSED
    compare = 0
    ifequal = 1
    else = _DBL_CLKD
    output = _DEFAULT_STATE_1

[button]
    button = B3.1 + _DEFAULT_STATE_1
    startvalue = B3.1
    reset = _RST_CH_BTNS
    led = L3.1
    output = _SEL_1

[button]
    button = B3.2 + _DBL_CLKD
    startvalue = B3.2
    reset = _RST_CH_BTNS
    led = L3.2
    output = _SEL_2

[button]
    button = B4.1 + _DBL_CLKD
    startvalue = B4.1
    reset = _RST_CH_BTNS
    led = L4.1
    output = _SEL_3

[button]
    button = B4.2 + _DBL_CLKD
    startvalue = B4.2
    reset = _RST_CH_BTNS
    led = L4.2
    output = _SEL_4

[button]
    button = B3.3 + _DBL_CLKD
    startvalue = B3.3
    reset = _RST_CH_BTNS
    led = L3.3
    output = _SEL_5

[button]
    button = B3.4 + _DBL_CLKD
    startvalue = B3.4
    reset = _RST_CH_BTNS
    led = L3.4
    output = _SEL_6

[button]
    button = B4.3 + _DBL_CLKD
    startvalue = B4.3
    reset = _RST_CH_BTNS
    led = L4.3
    output = _SEL_7

[button]
    button = B4.4 + _DBL_CLKD
    startvalue = B4.4
    reset = _RST_CH_BTNS
    led = L4.4
    output = _SEL_8

[buttongroup]
    button1 = B3.1
    button2 = B3.2
    button3 = B4.1
    button4 = B4.2
    button5 = B3.3
    button6 = B3.4
    button7 = B4.3
    button8 = B4.4
    value1 = 1
    value2 = 2
    value3 = 3
    value4 = 4
    value5 = 5
    value6 = 6 
    value7 = 7
    value8 = 8
    buttonpress = _CH_BUTTON_PRESSED
    output = _BTN_NUM

[mixer]
    input1 = _SEL_1
    input2 = _SEL_2
    input3 = _SEL_3
    input4 = _SEL_4
    input5 = _SEL_5
    input6 = _SEL_6
    input7 = _SEL_7
    input8 = _SEL_8
    output = _NUM_SELECTIONS

[mixer]
    input1 = B3.1
    input2 = B3.2
    input3 = B4.1
    input4 = B4.2
    input5 = B3.3
    input6 = B3.4
    input7 = B4.3
    input8 = B4.4
    output = _NUM_BUTTONS_PRESSED
    maximum = _SEL_BTN_PRSSD
    
[copy]
    input = _SEL_BTN_PRSSD
    inverted = _SEL_BTN_PRSSD_INV

# only send a reset trigger IF there is only one button being pressed
[compare]
    input = _NUM_BUTTONS_PRESSED
    compare = 1
    ifgreater = 0
    else = 1
    output = _SHOULD_RST_CH_BTNS

# # need to first find way to get number of buttons being held down.
# # if 2 or greater are held down, we know that we should NOT send a trigger to reset buttons.
# # otherwise send out a trigger to resets each time a button is pressed
# # exclude the currently held down button from getting reset.
[copy]
    input = _CH_BUTTON_PRESSED * _SHOULD_RST_CH_BTNS
    output = _RST_CH_BTNS

# -------------------------------------------------
# Algoquencers
# -------------------------------------------------

[algoquencer]
    select = _SEL_1 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_1
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_1
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_1 * _NUM_PAT + 20
    activity = _ACT_1
    variation = _VAR_1
    offbeats = _OFFBTS_1
    rolls = _RLLS_1
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_1
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_1 + 1
    lengthbutton = _LEN_MDE * _SEL_1
    # accentbutton = _ACC_MDE * _SEL_1 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_1
    gatelength = _G_LEN_1 + 0.07
    gate = _ALG_GATE_1
    accent = _ACCENT_1
    muteled = _MUTE_LED_1
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8
    startofbar = G11

[algoquencer]
    select = _SEL_2 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_2
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_2
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_2 * _NUM_PAT + 40
    activity = _ACT_2
    variation = _VAR_2
    offbeats = _OFFBTS_2
    rolls = _RLLS_2
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_2
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_2 + 1
    lengthbutton = _LEN_MDE * _SEL_2
    # accentbutton = _ACC_MDE * _SEL_2 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_2
    gatelength = _G_LEN_2 + 0.07
    gate = _ALG_GATE_2
    accent = _ACCENT_2
    muteled = _MUTE_LED_2
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_3 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_3
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_3
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_3 * _NUM_PAT + 60
    activity = _ACT_3
    variation = _VAR_3
    offbeats = _OFFBTS_3
    rolls = _RLLS_3
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_3
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_3 + 1
    lengthbutton = _LEN_MDE * _SEL_3
    # accentbutton = _ACC_MDE * _SEL_3 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_3
    gatelength = _G_LEN_3 + 0.07
    gate = _ALG_GATE_3
    accent = _ACCENT_3
    muteled = _MUTE_LED_3
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_4 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_4
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_4
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_4 * _NUM_PAT + 180 # algoquencer crashes at pattern=80, activity=1
    activity = _ACT_4
    variation = _VAR_4
    offbeats = _OFFBTS_4
    rolls = _RLLS_4
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_4
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_4 + 1
    lengthbutton = _LEN_MDE * _SEL_4
    # accentbutton = _ACC_MDE * _SEL_4 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_4
    gatelength = _G_LEN_4 + 0.07
    gate = _ALG_GATE_4
    accent = _ACCENT_4
    muteled = _MUTE_LED_4
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_5 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_5
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_5
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_5 * _NUM_PAT + 100
    activity = _ACT_5
    variation = _VAR_5
    offbeats = _OFFBTS_5
    rolls = _RLLS_5
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_5
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_5 + 1
    lengthbutton = _LEN_MDE * _SEL_5
    # accentbutton = _ACC_MDE * _SEL_5 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_5
    gatelength = _G_LEN_5 + 0.07
    gate = _ALG_GATE_5
    accent = _ACCENT_5
    muteled = _MUTE_LED_5
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_6 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_6
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_6
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_6 * _NUM_PAT + 120
    activity = _ACT_6
    variation = _VAR_6
    offbeats = _OFFBTS_6
    rolls = _RLLS_6
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_6
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_6 + 1
    lengthbutton = _LEN_MDE * _SEL_6
    # accentbutton = _ACC_MDE * _SEL_6 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_6
    gatelength = _G_LEN_6 + 0.07
    gate = _ALG_GATE_6
    accent = _ACCENT_6
    muteled = _MUTE_LED_6
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_7 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_7
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_7
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_7 * _NUM_PAT + 140
    activity = _ACT_7
    variation = _VAR_7
    offbeats = _OFFBTS_7
    rolls = _RLLS_7
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_7
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_7 + 1
    lengthbutton = _LEN_MDE * _SEL_7
    # accentbutton = _ACC_MDE * _SEL_7 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_7
    gatelength = _G_LEN_7 + 0.07
    gate = _ALG_GATE_7
    accent = _ACCENT_7
    muteled = _MUTE_LED_7
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

[algoquencer]
    select = _SEL_8 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_8
    reset = _RESET
    mutebutton = _MTE_SELECTION * _SEL_8
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _VAR_8 * _NUM_PAT + 160
    activity = _ACT_8
    variation = _VAR_8
    offbeats = _OFFBTS_8
    rolls = _RLLS_8
    rollcount = 1
    rollsteps = 1
    alternatebars = _ALT_8
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _DEJA_8 + 1
    lengthbutton = _LEN_MDE * _SEL_8
    # accentbutton = _ACC_MDE * _SEL_8 + _INIT_ACC
    accenthigh = 0.5
    clear = _CLR_ALGOS * _SEL_8
    gatelength = _G_LEN_8 + 0.07
    gate = _ALG_GATE_8
    accent = _ACCENT_8
    muteled = _MUTE_LED_8
    led1 = L1.5
    led2 = L1.6
    led3 = L2.5
    led4 = L2.6
    led5 = L3.5
    led6 = L3.6
    led7 = L4.5
    led8 = L4.6
    led9 = L1.7
    led10 = L1.8
    led11 = L2.7
    led12 = L2.8
    led13 = L3.7
    led14 = L3.8
    led15 = L4.7
    led16 = L4.8

# Show mutes on the selectors in all modes
[superjust]
    bypass = 1
    input1 = _MUTE_LED_1 * 0.2 + L3.1
    input2 = _MUTE_LED_2 * 0.2 + L3.2
    input3 = _MUTE_LED_3 * 0.2 + L4.1
    input4 = _MUTE_LED_4 * 0.2 + L4.2
    input5 = _MUTE_LED_5 * 0.2 + L3.3
    input6 = _MUTE_LED_6 * 0.2 + L3.4
    input7 = _MUTE_LED_7 * 0.2 + L4.3
    input8 = _MUTE_LED_8 * 0.2 + L4.4
    output1 = L3.1
    output2 = L3.2
    output3 = L4.1
    output4 = L4.2
    output5 = L3.3
    output6 = L3.4
    output7 = L4.3
    output8 = L4.4

# Output the gates to gate outputs.
[superjust]
    bypass = 1
    input1 = _ALG_GATE_1 + _MIDI_IN_GATE_1
    input2 = _ALG_GATE_2 + _MIDI_IN_GATE_2
    input3 = _ALG_GATE_3 + _MIDI_IN_GATE_3
    input4 = _ALG_GATE_4 + _MIDI_IN_GATE_4
    input5 = _ALG_GATE_5 + _MIDI_IN_GATE_5
    input6 = _ALG_GATE_6 + _MIDI_IN_GATE_6
    input7 = _ALG_GATE_7 + _MIDI_IN_GATE_7
    input8 = _ALG_GATE_8 + _MIDI_IN_GATE_8
    output1 = G1
    output2 = G2
    output3 = G3
    output4 = G4
    output5 = G5
    output6 = G6
    output7 = G7
    output8 = G8

# Algoquencers for CV outputs
[algoquencer]
    select = _SEL_1 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_1
    reset = _RESET + _RST_TMPO_1 
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_1 * _NUM_PAT + 20
    activity = _CV_ACT_1
    variation = _CV_VAR_1
    offbeats = _OFFBTS_1
    alternatebars = _ALT_1
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_1 + 1
    lengthbutton = _LEN_MDE * _SEL_1
    pitchlow = _CV_BASE_1
    pitchhigh = _CV_BASE_1 + _CV_SPRD_1
    pitchresolution = _CV_RES_1 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_1 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_1
    pitch = _CV_OUT_1

[algoquencer]
    select = _SEL_2 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_2
    reset = _RESET + _RST_TMPO_2
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_2 * _NUM_PAT + 40
    activity = _CV_ACT_2
    variation = _CV_VAR_2
    offbeats = _OFFBTS_2
    alternatebars = _ALT_2
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_2 + 1
    lengthbutton = _LEN_MDE * _SEL_2
    pitchlow = _CV_BASE_2
    pitchhigh = _CV_BASE_2 + _CV_SPRD_2
    pitchresolution = _CV_RES_2 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_2 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_2
    pitch = _CV_OUT_2

[algoquencer]
    select = _SEL_3 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_3
    reset = _RESET + _RST_TMPO_3
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_3 * _NUM_PAT + 60
    activity = _CV_ACT_3
    variation = _CV_VAR_3
    offbeats = _OFFBTS_3
    alternatebars = _ALT_3
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_3 + 1
    lengthbutton = _LEN_MDE * _SEL_3
    pitchlow = _CV_BASE_3
    pitchhigh = _CV_BASE_3 + _CV_SPRD_3
    pitchresolution = _CV_RES_3 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_3 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_3
    pitch = _CV_OUT_3

[algoquencer]
    select = _SEL_4 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_4
    reset = _RESET + _RST_TMPO_4
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_4 * _NUM_PAT + 80
    activity = _CV_ACT_4
    variation = _CV_VAR_4
    offbeats = _OFFBTS_4
    alternatebars = _ALT_4
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_4 + 1
    lengthbutton = _LEN_MDE * _SEL_4
    pitchlow = _CV_BASE_4
    pitchhigh = _CV_BASE_4 + _CV_SPRD_4
    pitchresolution = _CV_RES_4 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_4 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_4
    pitch = _CV_OUT_4

[algoquencer]
    select = _SEL_5 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_5
    reset = _RESET + _RST_TMPO_5
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_5 * _NUM_PAT + 100
    activity = _CV_ACT_5
    variation = _CV_VAR_5
    offbeats = _OFFBTS_5
    alternatebars = _ALT_5
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_5 + 1
    lengthbutton = _LEN_MDE * _SEL_5
    pitchlow = _CV_BASE_5
    pitchhigh = _CV_BASE_5 + _CV_SPRD_5
    pitchresolution = _CV_RES_5 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_5 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_5
    pitch = _CV_OUT_5

[algoquencer]
    select = _SEL_6 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_6
    reset = _RESET + _RST_TMPO_6
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_6 * _NUM_PAT + 120
    activity = _CV_ACT_6
    variation = _CV_VAR_6
    offbeats = _OFFBTS_6
    alternatebars = _ALT_6
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_6 + 1
    lengthbutton = _LEN_MDE * _SEL_6
    pitchlow = _CV_BASE_6
    pitchhigh = _CV_BASE_6 + _CV_SPRD_6
    pitchresolution = _CV_RES_6 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_6 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_6
    pitch = _CV_OUT_6

[algoquencer]
    select = _SEL_7 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_7
    reset = _RESET + _RST_TMPO_7
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_7 * _NUM_PAT + 140
    activity = _CV_ACT_7
    variation = _CV_VAR_7
    offbeats = _OFFBTS_7
    alternatebars = _ALT_7
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_7 + 1
    lengthbutton = _LEN_MDE * _SEL_7
    pitchlow = _CV_BASE_7
    pitchhigh = _CV_BASE_7 + _CV_SPRD_7
    pitchresolution = _CV_RES_7 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_7 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_7
    pitch = _CV_OUT_7

[algoquencer]
    select = _SEL_8 * _GTS_MDE
    preset = _PRST
    savepreset = _SV
    loadpreset = _LD
    clock = _TIM_CLK_8
    reset = _RESET + _RST_TMPO_8
    button1 = B1.5
    button2 = B1.6
    button3 = B2.5
    button4 = B2.6
    button5 = B3.5
    button6 = B3.6
    button7 = B4.5
    button8 = B4.6
    button9 = B1.7
    button10 = B1.8
    button11 = B2.7
    button12 = B2.8
    button13 = B3.7
    button14 = B3.8
    button15 = B4.7
    button16 = B4.8
    pattern = _CV_VAR_8 * _NUM_PAT + 160
    activity = _CV_ACT_8
    variation = _CV_VAR_8
    offbeats = _OFFBTS_8
    alternatebars = _ALT_8
    alternatebutton = _ALT_G_MDE * _CLR_ALGOS_INV + _INIT_ALT
    dejavu = _CV_DEJA_8 + 1
    lengthbutton = _LEN_MDE * _SEL_8
    pitchlow = _CV_BASE_8
    pitchhigh = _CV_BASE_8 + _CV_SPRD_8
    pitchresolution = _CV_RES_8 * 30 + 1
    # accentbutton = _ACC_MDE * _SEL_8 + _INIT_ACC
    clear = _CLR_ALGOS * _SEL_8
    pitch = _CV_OUT_8

[minifonion]
    bypass = _BYPSS_QUANT_1
    select1 = _C_1 + _C_OCT_1
    selectfill1 = _C_SH_1
    select9 = _D_1
    selectfill2 = _D_SH_1
    select3 = _E_1
    select11 = _F_1
    selectfill3 = _F_SH_1
    select5 = _G_1
    selectfill4 = _G_SH_1
    select13 = _A_1
    selectfill5 = _A_SH_1
    select7 = _B_1
    root = 0
    degree = 1
    input = _CV_OUT_1 + _ACCENT_1
    output = _CV_QUANT_1

[slew]
    input = _CV_QUANT_1
    slew = _SLEW_1
    exponential = O1

[minifonion]
    bypass = _BYPSS_QUANT_2
    select1 = _C_2 + _C_OCT_2
    selectfill1 = _C_SH_2
    select9 = _D_2
    selectfill2 = _D_SH_2
    select3 = _E_2
    select11 = _F_2
    selectfill3 = _F_SH_2
    select5 = _G_2
    selectfill4 = _G_SH_2
    select13 = _A_2
    selectfill5 = _A_SH_2
    select7 = _B_2
    root = 0
    degree = 1
    input = _CV_OUT_2 + _ACCENT_2
    output = _CV_QUANT_2

[slew]
    input = _CV_QUANT_2
    slew = _SLEW_2
    exponential = O2

[minifonion]
    bypass = _BYPSS_QUANT_3
    select1 = _C_3 + _C_OCT_3
    selectfill1 = _C_SH_3
    select9 = _D_3
    selectfill2 = _D_SH_3
    select3 = _E_3
    select11 = _F_3
    selectfill3 = _F_SH_3
    select5 = _G_3
    selectfill4 = _G_SH_3
    select13 = _A_3
    selectfill5 = _A_SH_3
    select7 = _B_3
    root = 0
    degree = 1
    input = _CV_OUT_3 + _ACCENT_3
    output = _CV_QUANT_3

[slew]
    input = _CV_QUANT_3
    slew = _SLEW_3
    exponential = O3

[minifonion]
    bypass = _BYPSS_QUANT_4
    select1 = _C_4 + _C_OCT_4
    selectfill1 = _C_SH_4
    select9 = _D_4
    selectfill2 = _D_SH_4
    select3 = _E_4
    select11 = _F_4
    selectfill3 = _F_SH_4
    select5 = _G_4
    selectfill4 = _G_SH_4
    select13 = _A_4
    selectfill5 = _A_SH_4
    select7 = _B_4
    root = 0
    degree = 1
    input = _CV_OUT_4 + _ACCENT_4
    output = _CV_QUANT_4

[slew]
    input = _CV_QUANT_4
    slew = _SLEW_4
    exponential = O4

[minifonion]
    bypass = _BYPSS_QUANT_5
    select1 = _C_5 + _C_OCT_5
    selectfill1 = _C_SH_5
    select9 = _D_5
    selectfill2 = _D_SH_5
    select3 = _E_5
    select11 = _F_5
    selectfill3 = _F_SH_5
    select5 = _G_5
    selectfill4 = _G_SH_5
    select13 = _A_5
    selectfill5 = _A_SH_5
    select7 = _B_5
    root = 0
    degree = 1
    input = _CV_OUT_5 + _ACCENT_5
    output = _CV_QUANT_5

[slew]
    input = _CV_QUANT_5
    slew = _SLEW_5
    exponential = O5

[minifonion]
    bypass = _BYPSS_QUANT_6
    select1 = _C_6 + _C_OCT_6
    selectfill1 = _C_SH_6
    select9 = _D_6
    selectfill2 = _D_SH_6
    select3 = _E_6
    select11 = _F_6
    selectfill3 = _F_SH_6
    select5 = _G_6
    selectfill4 = _G_SH_6
    select13 = _A_6
    selectfill5 = _A_SH_6
    select7 = _B_6
    root = 0
    degree = 1
    input = _CV_OUT_6 + _ACCENT_6
    output = _CV_QUANT_6

[slew]
    input = _CV_QUANT_6
    slew = _SLEW_6
    exponential = O6

[minifonion]
    bypass = _BYPSS_QUANT_7
    select1 = _C_7 + _C_OCT_7
    selectfill1 = _C_SH_7
    select9 = _D_7
    selectfill2 = _D_SH_7
    select3 = _E_7
    select11 = _F_7
    selectfill3 = _F_SH_7
    select5 = _G_7
    selectfill4 = _G_SH_7
    select13 = _A_7
    selectfill5 = _A_SH_7
    select7 = _B_7
    root = 0
    degree = 1
    input = _CV_OUT_7 + _ACCENT_7
    output = _CV_QUANT_7

[slew]
    input = _CV_QUANT_7
    slew = _SLEW_7
    exponential = O7

[minifonion]
    bypass = _BYPSS_QUANT_8
    select1 = _C_8 + _C_OCT_8
    selectfill1 = _C_SH_8
    select9 = _D_8
    selectfill2 = _D_SH_8
    select3 = _E_8
    select11 = _F_8
    selectfill3 = _F_SH_8
    select5 = _G_8
    selectfill4 = _G_SH_8
    select13 = _A_8
    selectfill5 = _A_SH_8
    select7 = _B_8
    root = 0
    degree = 1
    input = _CV_OUT_8 + _ACCENT_8
    output = _CV_QUANT_8

[slew]
    input = _CV_QUANT_8
    slew = _SLEW_8
    exponential = O8

# Show the active gate outs also on the selector buttons, for convenience when in the other modes besides gate mode.
[superjust]
    bypass = 1
    input1 = G1 + L3.1
    input2 = G2 + L3.2
    input3 = G3 + L4.1
    input4 = G4 + L4.2
    input5 = G5 + L3.3
    input6 = G6 + L3.4
    input7 = G7 + L4.3
    input8 = G8 + L4.4
    output1 = L3.1
    output2 = L3.2
    output3 = L4.1
    output4 = L4.2
    output5 = L3.3
    output6 = L3.4
    output7 = L4.3
    output8 = L4.4

# -------------------------------------------------
# Midi Out
# -------------------------------------------------

[compare]
    input = _MIDI_NOTE_SEL
    compare = 0.02
    ifless = 1
    else = 0
    output = _DRUMS

[compare]
    input = _MIDI_NOTE_SEL
    compare = 0.02
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_8

[compare]
    input = _MIDI_NOTE_SEL
    compare = 1
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_7

[compare]
    input = _MIDI_NOTE_SEL
    compare = 2
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_6

[compare]
    input = _MIDI_NOTE_SEL
    compare = 3
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_5

[compare]
    input = _MIDI_NOTE_SEL
    compare = 4
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_4

[compare]
    input = _MIDI_NOTE_SEL
    compare = 5
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_3

[compare]
    input = _MIDI_NOTE_SEL
    compare = 6
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_2

[compare]
    input = _MIDI_NOTE_SEL
    compare = 7
    ifgreater = 1
    else = 0
    output = _MIDI_SEL_1

[midiout]
    channel = _MIDI_OUT_CHANNEL + 1
    usb = 1
    pitch1 = _CV_QUANT_8 + 5V
    pitch2 = _CV_QUANT_7 + 5V
    pitch3 = _CV_QUANT_6 + 5V
    pitch4 = _CV_QUANT_5 + 5V
    pitch5 = _CV_QUANT_4 + 5V
    pitch6 = _CV_QUANT_3 + 5V
    pitch7 = _CV_QUANT_2 + 5V
    pitch8 = _CV_QUANT_1 + 5V
    gate1 = _ALG_GATE_8 * _MIDI_SEL_8
    gate2 = _ALG_GATE_7 * _MIDI_SEL_7
    gate3 = _ALG_GATE_6 * _MIDI_SEL_6
    gate4 = _ALG_GATE_5 * _MIDI_SEL_5
    gate5 = _ALG_GATE_4 * _MIDI_SEL_4
    gate6 = _ALG_GATE_3 * _MIDI_SEL_3
    gate7 = _ALG_GATE_2 * _MIDI_SEL_2
    gate8 = _ALG_GATE_1 * _MIDI_SEL_1
    notegate1 = G1 * _DRUMS
    notegate2 = G2 * _DRUMS
    notegate3 = G3 * _DRUMS
    notegate4 = G4 * _DRUMS
    notegate5 = G5 * _DRUMS
    notegate6 = G6 * _DRUMS
    notegate7 = G7 * _DRUMS
    notegate8 = G8 * _DRUMS
    cc1 = O1 + 5V
    cc2 = O2 + 5V
    cc3 = O3 + 5V
    cc4 = O4 + 5V
    cc5 = O5 + 5V
    cc6 = O6 + 5V
    cc7 = O7 + 5V
    cc8 = O8 + 5V
    ccnumber1 = 102
    ccnumber2 = 103
    ccnumber3 = 104
    ccnumber4 = 105
    ccnumber5 = 106
    ccnumber6 = 107
    ccnumber7 = 108
    ccnumber8 = 109